<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Radish'blog" href="http://rainyblue.cn/rss.xml"><link rel="alternate" type="application/atom+xml" title="Radish'blog" href="http://rainyblue.cn/atom.xml"><link rel="alternate" type="application/json" title="Radish'blog" href="http://rainyblue.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="期末复习,Python,数据分析"><link rel="canonical" href="http://rainyblue.cn/2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/"><title>数据分析复习（第四章） - 数据分析 - Python语言 - 学习类 | ShokaBlog = Radish'blog</title><meta name="generator" content="Hexo 7.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="container"><div class="loader"><div class="loader--dot"></div><div class="loader--dot"></div><div class="loader--dot"></div><div class="loader--dot"></div><div class="loader--dot"></div><div class="loader--dot"></div><div class="loader--text"></div></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">数据分析复习（第四章）</h1><div class="meta"><span class="item" title="创建时间：2024-06-18 09:01:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-06-18T09:01:00+08:00">2024-06-18</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>9.6k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>24 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ShokaBlog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/img2024092.jpg"></li><li class="item" data-background-image="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/img2024155.jpg"></li><li class="item" data-background-image="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/img2024274.jpg"></li><li class="item" data-background-image="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/img2024083.jpg"></li><li class="item" data-background-image="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/img2024080.jpg"></li><li class="item" data-background-image="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/img2024047.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><div id="bgpic"><div id="mask"></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Educational/" itemprop="item" rel="index" title="分类于 学习类"><span itemprop="name">学习类</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Educational/python/" itemprop="item" rel="index" title="分类于 Python语言"><span itemprop="name">Python语言</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Educational/python/Data-analysis/" itemprop="item" rel="index" title="分类于 数据分析"><span itemprop="name">数据分析</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://rainyblue.cn/2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="萝卜仔"><meta itemprop="description" content=", Only studying is exalted."></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Radish'blog"></span><div class="body md" itemprop="articleBody"><p>应对期末考试，对本学期《Python 数据分析与应用》课程学习的内容进行复习。</p><span id="more"></span><hr><h1 id="第四章-pandas进行数据预处理"><a class="anchor" href="#第四章-pandas进行数据预处理">#</a> 第四章、pandas 进行数据预处理</h1><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/1719038031036.png" alt="1719038031036"></p><h2 id="一-堆叠合并数据"><a class="anchor" href="#一-堆叠合并数据">#</a> 一、堆叠合并数据</h2><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622143713236.png" alt="image-20240622143713236"></p><h3 id="1轴向堆叠合并数据"><a class="anchor" href="#1轴向堆叠合并数据">#</a> 1. 轴向堆叠合并数据</h3><p>函数：pandas.concat (参数)，concat 函数主要参数如下，axis 是关键，它用于指定合并的轴是行还是列：</p><p>​</p><table><thead><tr><th><strong>参数名称</strong></th><th><strong>参数说明</strong></th></tr></thead><tbody><tr><td>objs</td><td>接收多个 Series、DataFrame、Panel 的组合。表示参与连接的 pandas 对象的列表的组合。无默认值</td></tr><tr><td>axis</td><td>接收 int。表示连接的轴向，可选 0 和 1。默认为 0</td></tr><tr><td><strong>join</strong></td><td>接收 str。表示其他轴向上的索引是按交集（inner）还是并集（outer）进行合并。默认为 outer</td></tr><tr><td><strong>ignore_index</strong></td><td>接收 bool。表示是否不保留连接轴上的索引，产生一组新索引 range (total_length)。默认为 False</td></tr><tr><td><strong>keys</strong></td><td>接收 sequence。表示与连接对象有关的值，用于形成连接轴向上的层次化索引。默认为 None</td></tr><tr><td><strong>levels</strong></td><td>接收包含多个 sequence 的 list。表示在指定 keys 参数后，指定用作层次化索引各级别上的索引。默认为 None</td></tr><tr><td><strong>names</strong></td><td>接收 list。表示在设置了 keys 和 levels 参数后，用于创建分层级别的名称。默认为 None</td></tr><tr><td><strong>verify_integrity</strong></td><td>接收 bool。表示检查新连接的轴是否包含重复项，如果发现重复项，那么引发异常。默认为 False</td></tr><tr><td><strong>sort</strong></td><td>接收 bool。表示对非连接轴进行排序。默认为 False</td></tr></tbody></table><ul><li><p>横向堆叠：行对齐，然后将不同列名称的两张或多张表合并。索引不同，join 参数用于设置连接可选 inner 或 outer，索引完全相同，join 设置任何值都是直接将两个表在 x 轴向拼接在一起。</p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622143940387.png" alt="image-20240622143940387"></p></li><li><p>纵向堆叠：列对齐，将不同行索引的两张或多张表纵向合并。列名并不完全相同，当 join 参数取值为 inner 时，返回的仅仅是列名的交集所代表的列。当 join 参数取值为 outer 时，返回的是两者列名的并集所代表的列。当两张表的列名完全相同时，不论 join 参数的取值是 inner 还是 outer，结果都是将两个表完全按照<em> y</em> 轴拼接起来。</p></li><li><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622143946855.png" alt="image-20240622143946855"></p></li></ul><p>函数：append () 方法，方法主要使用格式及参数如下：</p><p>pandas.DataFrame.append (参数)</p><table><thead><tr><th><strong>参数名称</strong></th><th><strong>参数说明</strong></th></tr></thead><tbody><tr><td><strong>other</strong></td><td>接收 DataFrame 或 Series。表示要添加的新数据。无默认值</td></tr><tr><td><strong>ignore_index</strong></td><td>接收 bool。如果输入 True，那么就会对新生成的 DataFrame 使用新的索引（自动产生），而忽略原来数据的索引。默认为 False</td></tr><tr><td><strong>verify_integrity</strong></td><td>接收 bool。如果输入 True，那么当 ignore_index 为 False 时，会检查添加的数据索引是否冲突，若冲突，则会添加失败。默认为 False</td></tr><tr><td><strong>sort</strong></td><td>接收 bool。如果输入 True，那么会对合并的两个表的列进行排序。默认为 False</td></tr></tbody></table><p>用于纵向合并两张表。但是使用 append () 方法实现纵向表堆叠的前提条件是两张表的列名需要完全一致。append () 方法的基本使用格式如下。</p><p>案例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</pre></td></tr><tr><td data-num="3"></td><td><pre>df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#默认 axis=0</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#默认 join='ourter'</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>join<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">#默认 join='ourter'</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>join<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">#axis=0 (纵向)，join=inner（内连接交集），ignore_index=True (重新设置索引)</span></pre></td></tr></table></figure><h3 id="2-主键合并数据"><a class="anchor" href="#2-主键合并数据">#</a> 2、主键合并数据</h3><p>通过一个或多个键将两个数据集的行连接起来，类似于关系型数据库的连接方式中的 join。针对两张包含不同特征的表，将根据某几个特征一一对应拼接起来，合并后数据的列数为两个原数据的列数和减去连接键的数量。</p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622144151012.png" alt="image-20240622144151012"></p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622144155297.png" alt="image-20240622144155297"></p><p>函数：pandas.merge (参数)，函数主要参数如下：</p><table><thead><tr><th><strong>参数名称</strong></th><th><strong>参数说明</strong></th></tr></thead><tbody><tr><td><strong>left</strong></td><td>接收 DataFrame 或 Series。表示要添加的新数据 1。无默认值</td></tr><tr><td><strong>right</strong></td><td>接收 DataFrame 或 Series。表示要添加的新数据 2。无默认值</td></tr><tr><td><strong>how</strong></td><td>接收 “inner”“outer”“left” 或 “right”。表示数据的连接方式。默认为 inner</td></tr><tr><td><strong>on</strong></td><td>接收 str 或 sequence。表示两个数据合并的主键（必须一致）。默认为 None</td></tr><tr><td><strong>left_on</strong></td><td>接收 str 或 sequence。表示 left 参数接收数据用于合并的主键。默认为 None</td></tr><tr><td>right_on</td><td>接收 str 或 sequence。表示 right 参数接收数据用于合并的主键。默认为 None</td></tr><tr><td>left_index</td><td>接收 bool。表示是否将 left 参数接收数据的 index 作为连接主键。默认为 False</td></tr><tr><td>right_index</td><td>接收 bool。表示是否将 right 参数接收数据的 index 作为连接主键。默认为 False</td></tr><tr><td>sort</td><td>接收 bool。表示是否根据连接键对合并后的数据进行排序。默认为 False</td></tr><tr><td>suffixes</td><td>接收 tuple。表示用于追加到 left 和 right 参数接收数据列名相同时的后缀。默认为 ('_x', '_y')</td></tr></tbody></table><p>案例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'id'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'ctg'</span><span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'AABCB'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'id'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'ticket'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'1001'</span><span class="token punctuation">,</span><span class="token string">'1002'</span><span class="token punctuation">,</span><span class="token string">'1003'</span><span class="token punctuation">,</span><span class="token string">'1004'</span><span class="token punctuation">,</span><span class="token string">'1005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'amount'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">24.1</span><span class="token punctuation">,</span><span class="token number">32.5</span><span class="token punctuation">,</span><span class="token number">34.8</span><span class="token punctuation">,</span><span class="token number">19.5</span><span class="token punctuation">,</span><span class="token number">26.2</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>new <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token string">'id'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>new<span class="token punctuation">)</span></pre></td></tr></table></figure><p>总结（综上所述）：</p><p>1、concat 实现的只是将两个 df 按行或者列简单进行拼接，并没有实现 sql 中的 join 功能。</p><p>2、要想实现 sql 中的 join，需要使用 merge 方法。</p><h2 id="二-pandas清洗数据"><a class="anchor" href="#二-pandas清洗数据">#</a> 二、Pandas 清洗数据</h2><h3 id="1-检测与处理重复值"><a class="anchor" href="#1-检测与处理重复值">#</a> 1、检测与处理重复值</h3><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622144416065.png" alt="image-20240622144416065"></p><p>记录重复，同一列不同数据是否相同：pd.dataframe.drop_duplicates (参数)</p><table><thead><tr><th><strong>参数名称</strong></th><th><strong>参数说明</strong></th></tr></thead><tbody><tr><td><strong>subset</strong></td><td>接收 str 或 sequence。表示进行去重的列。默认为 None</td></tr><tr><td><strong>keep</strong></td><td>接收特定 str。表示重复时保留第几个数据，“first” 表示保留第一个；“last” 表示保留最后一个；False 表示只要有重复都不保留。默认为 first</td></tr><tr><td><strong>inplace</strong></td><td>接收 bool。表示是否在原表上进行操作。默认为 False</td></tr><tr><td><strong>ignore_index</strong></td><td>接收 bool。表示是否忽略索引。默认为 False</td></tr></tbody></table><p>特征重复（不同列之间数据是否相同）：使用 corr 方法计算相似度。</p><p>dataframe.corr (method)，method 方法有：pearson（皮尔森，两组变量中任何一组中的值不能都是相同、同一组中的值不能差距太大，即如果有异常值相关性会干扰）、spearman（斯皮尔曼，根据原始数据的排序位置进行求解，异常值不会干扰）、kendall（肯德尔）秩相关系数，它也是一种秩相关系数，不过它所计算的对象主要是分类变量，比如无序的 --- 性别（男、女）、血型（A、B、O、AB），有序的 --- 比如肥胖等级（重度肥胖，中度肥胖、轻度肥胖、不肥胖）。</p><p>但要注意：只能针对数值型特征计算相似度。无法实现对类别型特征计算相似度矩阵，如果遇到特征值可转换。</p><p>案例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>core <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">r'data\core.xlsx'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"以下是pearson（皮尔森)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'E'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'pearson'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#pearson（皮尔森)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'G'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'pearson'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#pearson（皮尔森), 有一个列值相同</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'pearson'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#pearson（皮尔森)，有异常值</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"以下是spearman（斯皮尔曼)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'E'</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'spearman'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">#spearman（斯皮尔曼)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'spearman'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">#spearman（斯皮尔曼)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"以下是kendall(肯德尔)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>core<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'kendall'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#kendall (肯德尔)</span></pre></td></tr></table></figure><h3 id="2-检测与处理缺失值"><a class="anchor" href="#2-检测与处理缺失值">#</a> 2、检测与处理缺失值</h3><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622144658241.png" alt="image-20240622144658241"></p><p>（1）缺失（空）值判断：pd.isnull (data)、pd.isna (data) 或 data.isnull ()、data.isna ()</p><p>（2）缺失（空）值处理：</p><p>删除：data.dropna (axis),axis 参数用于设置移除行或列</p><p>替换：data.fillna (value,method)</p><p>methodà’bfill’: 后一个值填充，methodà’ffill’: 前一个值填充</p><p>插值：线性插值，多项式插值，样条插值</p><p>案例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#线性插值</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>interpolate <span class="token keyword">import</span> interp1d</pre></td></tr><tr><td data-num="3"></td><td><pre>x <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'x'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>y1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'y1'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">162</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>y2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'y2'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>y2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>data1 <span class="token operator">=</span> interp1d<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token string">'y1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>kind<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>data2 <span class="token operator">=</span> interp1d<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token string">'y2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>kind<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data1<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data2<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="3-检测与处理异常值"><a class="anchor" href="#3-检测与处理异常值">#</a> 3、检测与处理异常值</h3><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622144949435.png" alt="image-20240622144949435"></p><p>符合正态分布的值：3σ(大写 Σ) 原则 --- 数据量较大、格拉布斯准则 --- 检验较少数据</p><p>3σ 原则又称为拉依达准则，其原则就是先假设一组检测数据只含有随机误差，对原始数据进行计算处理得到标准差，然后按一定的概率确定一个区间，认为误差超过这个区间就属于异常。</p><p>3σ 原则仅适用于对正态或近似正态分布的样本数据进行处理。正态分布数据的 3σ 原则如下表所示，其中 σ 代表标准差 (std)，μ 代表均值 (mean)。数据的数值分布几乎全部集中在区间 (μ-3σ,μ+3σ) 内，超出这个范围的数据仅占不到 0.3%。故根据小概率原理，可以认为超出 3σ 的部分为异常数据。</p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622145008150.png" alt="image-20240622145008150"></p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622145011041.png" alt="image-20240622145011041"></p><p>案例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#读取 data\core.xlsx 文件中的数据，使用 3σ 原则分析 D 列是否存在异常值。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd </pre></td></tr><tr><td data-num="3"></td><td><pre>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">r'data\core.xlsx'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">out_range</span><span class="token punctuation">(</span>ser1<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    bool_ind <span class="token operator">=</span> <span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">*</span>ser1<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span>ser1<span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span>ser1<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span> ser1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    index <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>bool_ind<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    outrange <span class="token operator">=</span> ser1<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>index<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> outrange</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>out <span class="token operator">=</span> out_range<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span></pre></td></tr></table></figure><p>离散值：箱线图分析</p><p>箱线图提供了识别异常值的一个标准，即异常值通常被定义为小于 QL-1.5IQR 或大于 QU+1.5IQR 的值。</p><p>・QL 称为下四分位数，表示全部观察值中有四分之一的数据取值比它小；</p><p>・QU 称为上四分位数，表示全部观察值中有四分之一的数据取值比它大；</p><p>・IQR 称为四分位数间距，是上四分位数 QU 与下四分位数 QL 之差，其间包含了全部观察值的一半。</p><p>案例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#读取 data\core.xlsx 文件中的数据，使用箱线图分析年龄异常值。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span>  matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</pre></td></tr><tr><td data-num="4"></td><td><pre>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">r'data\core.xlsx'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">160</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>p <span class="token operator">=</span> plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>outlier1 <span class="token operator">=</span> p<span class="token punctuation">[</span><span class="token string">'fliers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get_ydata<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">r'data/异常.jpg'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="三-pandas量纲化数据"><a class="anchor" href="#三-pandas量纲化数据">#</a> 三、Pandas 量纲化数据</h2><p>不同特征往往具有不同的量纲，涉及空间距离计算或使用梯度下降法时，不对数据进行处理可能会影响数据分析结果。为了消除因特征之间的量纲和取值范围差异对数据分析可能造成的影响，保证数据的一致性，需要进行规范化（量纲化）处理。量纲化有很多种方式，但具体应该使用那一种方式，并没有固定的标准，而应该结合数据情况或者研究算法，选择最适合的量纲化处理方式，量纲化处理方法常见的有如下图所示：</p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622145117940.png" alt="image-20240622145117940"></p><h3 id="1-归一化数据"><a class="anchor" href="#1-归一化数据">#</a> <strong>1、</strong> <strong>归一化数据</strong></h3><p>离差标准化是对原始数据的一种线性变换，结果是将原始数据的数值映射到 [0,1] 区间，转换公式如下：</p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622145123830.png" alt="image-20240622145123830"></p><p>max 为样本数据的最大值，min 为样本数据的最小值，max-min 为极差。</p><p>离差标准化的缺点：若数值集中某个数值很大，则规范化后各其余值会接近于 0，并且将会相差不大。</p><h3 id="2-标准差标准化数据"><a class="anchor" href="#2-标准差标准化数据">#</a> <strong>2、</strong> <strong>标准差标准化数据</strong></h3><p>标准差标准化也叫零均值标准化或分数标准化，是当前使用较为广泛的数据标准化方法，经过该方法处理的数据均值为 0，标准差为 1，转化公式如下式：</p><p><img data-src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/rainyblue1001/image/main/img/image-20240622145129617.png" alt="image-20240622145129617"></p><p>其中， 为原始数据的均值，<em>d</em> 为原始数据的标准差。标准差标准化后的值区间不局限于 [0,1]，并且存在负值。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler</pre></td></tr><tr><td data-num="4"></td><td><pre>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'北京'</span><span class="token punctuation">,</span><span class="token string">'-5'</span><span class="token punctuation">,</span><span class="token string">'25'</span><span class="token punctuation">,</span><span class="token string">'18'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                     <span class="token punctuation">[</span><span class="token string">'上海'</span><span class="token punctuation">,</span><span class="token string">'-2'</span><span class="token punctuation">,</span><span class="token string">'27'</span><span class="token punctuation">,</span><span class="token string">'20'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                     <span class="token punctuation">[</span><span class="token string">'广州'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">'33'</span><span class="token punctuation">,</span><span class="token string">'25'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                     <span class="token punctuation">[</span><span class="token string">'深圳'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">,</span><span class="token string">'35'</span><span class="token punctuation">,</span><span class="token string">'28'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'地区'</span><span class="token punctuation">,</span><span class="token string">'最低气温'</span><span class="token punctuation">,</span><span class="token string">'最高气温'</span><span class="token punctuation">,</span><span class="token string">'最常气温'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">#标准差（Z-score) 标准化数据</span></pre></td></tr><tr><td data-num="10"></td><td><pre>s_scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>df <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"标准差（Z-score)标准化数据:"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>s_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">#归一化 (离差）标准化数据</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"归一化(离差）标准化数据:"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>max_min_scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>max_min_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="22"></td><td><pre>pay <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">r'data/user_pay_info.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment"># 自定义离差标准化函数</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">def</span> <span class="token function">min_max_scale</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">(</span>data <span class="token operator">-</span> data<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> data<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">return</span> data</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment"># 对用户每月支出信息表的每月支出数据做离差标准化</span></pre></td></tr><tr><td data-num="28"></td><td><pre>pay_min_max <span class="token operator">=</span> min_max_scale<span class="token punctuation">(</span>pay<span class="token punctuation">[</span><span class="token string">'每月支出'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'离差标准化之前每月支出数据为：\n'</span><span class="token punctuation">,</span> pay<span class="token punctuation">[</span><span class="token string">'每月支出'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'离差标准化之后每月支出数据为\n'</span><span class="token punctuation">,</span> pay_min_max<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment"># 自定义标准差标准化函数</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">def</span> <span class="token function">standard_scaler</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">(</span>data <span class="token operator">-</span> data<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> data<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">return</span> data</pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment"># 对用户每月支出信息表的每月支出数据做标准差标准化</span></pre></td></tr><tr><td data-num="37"></td><td><pre>pay_standard <span class="token operator">=</span> standard_scaler<span class="token punctuation">(</span>pay<span class="token punctuation">[</span><span class="token string">'每月支出'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'标准差标准化之前每月支出数据为：\n'</span><span class="token punctuation">,</span> pay<span class="token punctuation">[</span><span class="token string">'每月支出'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'标准差标准化之后每月支出数据为：\n'</span><span class="token punctuation">,</span> pay_standard<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>两种标准化数据的比较：</p><p>离差标准化方法简单，便于理解，标准化后的数据限定在 [0,1] 区间内。</p><p>标准差标准化受数据分布的影响较小，大于 0 说明高于平均水平，小于 0 说明低于平均水平。</p><h2 id="四-pandas变换数据"><a class="anchor" href="#四-pandas变换数据">#</a> 四、Pandas 变换数据</h2><h3 id="1-哑变量处理类别型数据"><a class="anchor" href="#1-哑变量处理类别型数据">#</a> 1、哑变量处理类别型数据</h3><p>分析模型中有相当一部分的算法模型都要求输入的特征为数值型，但实际数据中，特征的类型不一定只有数值型，还会存在相当一部分的类别型，这部分的特征需要经过哑变量处理才可以放入模型之中。</p><p>使用 pandas 库的 get_dummies 函数对类别型变量作哑变量处理。</p><p>对于一个类别型特征，若其取值有 m 个，则经过哑变量处理后就变成了 m 个二元特征，并且这些特征互斥，每次只有一个激活，这使得数据变得稀疏。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 将特定的数据 转化为 可以使用的数据 --- 数据变换</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 两种情况：</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 第一种：哑变量转化 -- 利用 pandas 库中的 get_dummies () 函数进行哑变量处理</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 通常与 PCA（主成分分析）一起使用，即构造哑变量产生高维数据后采用 PCA 进行降维。</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># pd.get_dummmies(data,prefix,prefix_sep)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># data : 需要转化的数据</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># prefix: 转化之后列名称的前缀</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 1、将年龄列（非数值型）数据 -----> 数值型</span></pre></td></tr><tr><td data-num="9"></td><td><pre>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">r'data\core.xlsx'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'性别'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>newagedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'性别'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>prefix<span class="token operator">=</span><span class="token string">'性别_'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 哑变量转化为数值型数据，维度两例，可降维（删除其中一列）</span></pre></td></tr><tr><td data-num="13"></td><td><pre>newagedata <span class="token operator">=</span> newagedata<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token string">'性别__男'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>newagedata <span class="token operator">=</span> newagedata<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'性别__女'</span><span class="token punctuation">:</span><span class="token string">'性别'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 2、将城市列（非数值型）数据 -----> 数值型</span></pre></td></tr><tr><td data-num="17"></td><td><pre>newcitydata <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>prefix<span class="token operator">=</span><span class="token string">'城市_'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>newcitydata<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">#哑变量转化为数值型数据，维度太多，降维不好处理。</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">#（1）Label Encoding 给对应进行编号处理，使用 LabelEncoder () 函数将文本类型的数据转换成数字（随机）</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder</pre></td></tr><tr><td data-num="22"></td><td><pre>le <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>label <span class="token operator">=</span> le<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>data<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">#（2）pandas 库中的 replace () 函数，按特定内容进行替换</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment"># 先利用 value_counts () 函数查看 “城市” 列有哪些内容需要替换</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>data<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'北京'</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token string">'上海'</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'广州'</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'深圳'</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'佛山'</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="2-离散化连续型数据"><a class="anchor" href="#2-离散化连续型数据">#</a> 2、离散化连续型数据</h3><p>某些模型算法，特别是某些分类算法，如 ID3 决策树算法和 Apriori 算法等，要求数据是离散的。</p><p>此时就需要将连续型特征（数值型）变换成离散型特征（类别型），即连续特征离散化。</p><p>离散化涉及两个子任务，即确定分类数以及如何将连续型数据映射到这些类别型数据上。</p><p>等宽法：利用 pandas 的 cut 函数（将数据的值域分成具有相同宽度的区间，区间的个数由数据本身特点或者用户指定。）</p><p>等频法：cut 函数虽然不能够直接实现等频离散化，但是可以通过定义将相同数量的记录放进每个区间。</p><p>聚类分析法：将连续型数据使用聚类算法（k-means）进行聚类，再处理聚类得到的簇，为合并到一个簇的连续型数据做同一种标记。</p><p>①等宽法缺点：若数据分布不均匀，则等宽 cut 之后各个类的数目也会变得不均匀。</p><p>②等频法缺点：频法离散化，相较于等宽法离散化，避免了类分布不均匀的问题，但同时也有可能将数值非常接近的两个值分到不同的区间以满足每个区间对数据个数的要求。</p><p>③聚类分析法（连续型数据用聚类算法，如 k-means），使用频率高。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>all_info <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">r'data\user_all_info.csv'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>all_info<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#等宽离散化 -- 将该列中所有的年龄值按设置的等份平均划分</span></pre></td></tr><tr><td data-num="4"></td><td><pre>age_cut <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>all_info<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'等宽离散化后记录的年龄分布为:\n'</span><span class="token punctuation">,</span>age_cut<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">#等频离散化 -- 将相同数量的记录放置在每个区间</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span>  numpy <span class="token keyword">as</span> np</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">same_rate</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    w <span class="token operator">=</span> data<span class="token punctuation">.</span>quantile<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1.0</span><span class="token operator">/</span>k<span class="token punctuation">,</span><span class="token number">1.0</span><span class="token operator">/</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>data<span class="token punctuation">,</span>w<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> data</pre></td></tr><tr><td data-num="12"></td><td><pre>age_same_rate <span class="token operator">=</span> same_rate<span class="token punctuation">(</span>all_info<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'等频离散化后记录的年龄分布为:\n'</span><span class="token punctuation">,</span>age_same_rate<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">#聚类离散化 --- 使用 Kmeans 进行聚类，得到簇，用户指定簇的个数，用于决定生成的区间数</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">def</span> <span class="token function">kmean_cut</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span>  KMeans</pre></td></tr><tr><td data-num="18"></td><td><pre>    kmodel <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>k<span class="token punctuation">)</span>  <span class="token comment">#用户指定的簇的个数调用 KMeans 算法标记数据</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    kmodel<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data<span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#训练数据模型</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    c <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>kmodel<span class="token punctuation">.</span>cluster_centers_<span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">#输出聚类中心并排序</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    w <span class="token operator">=</span> c<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment">#对相邻两项求中点，作为边界点</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    w <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">[</span>data<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment">#把首末边界点加上</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>data<span class="token punctuation">,</span> w<span class="token punctuation">)</span>  <span class="token comment">#调用 cut 函数将标记后的数据离散化处理</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">return</span>  data</pre></td></tr><tr><td data-num="25"></td><td><pre>all_info<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment">#将表内年龄列为空的数据删除（inplace = True 表示原表操作）</span></pre></td></tr><tr><td data-num="26"></td><td><pre>age_kmeans <span class="token operator">=</span> kmean_cut<span class="token punctuation">(</span>all_info<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'聚类离散化后记录的年龄分布为:\n'</span><span class="token punctuation">,</span>age_kmeans<span class="token punctuation">)</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/" rel="tag"><i class="ic i-tag"></i> 期末复习</a> <a href="/tags/Python/" rel="tag"><i class="ic i-tag"></i> Python</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" rel="tag"><i class="ic i-tag"></i> 数据分析</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-06-23 18:07:54" itemprop="dateModified" datetime="2024-06-23T18:07:54+08:00">2024-06-23</time> </span><span id="2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/" class="item leancloud_visitors" data-flag-title="数据分析复习（第四章）" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="萝卜仔 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="萝卜仔 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>萝卜仔 <i class="ic i-at"><em>@</em></i>Radish'blog</li><li class="link"><strong>本文链接：</strong> <a href="http://rainyblue.cn/2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/" title="数据分析复习（第四章）">http://rainyblue.cn/2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/06/18/Educational/python/Data-analysis/Data_analysis_review3/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;images.weserv.nl&#x2F;?url&#x3D;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;rainyblue1001&#x2F;image&#x2F;main&#x2F;img&#x2F;img2024205.jpg" title="数据分析复习（第三章）"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 数据分析</span><h3>数据分析复习（第三章）</h3></a></div><div class="item right"><a href="/2024/06/19/Educational/WeChat/WeChat_Program1/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;images.weserv.nl&#x2F;?url&#x3D;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;rainyblue1001&#x2F;image&#x2F;main&#x2F;img&#x2F;img2024268.jpg" title="第一章：小程序入门"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 微信小程序开发</span><h3>第一章：小程序入门</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-pandas%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">第四章、pandas 进行数据预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%A0%86%E5%8F%A0%E5%90%88%E5%B9%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.</span> <span class="toc-text">一、堆叠合并数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E8%BD%B4%E5%90%91%E5%A0%86%E5%8F%A0%E5%90%88%E5%B9%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. 轴向堆叠合并数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%BB%E9%94%AE%E5%90%88%E5%B9%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">2、主键合并数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-pandas%E6%B8%85%E6%B4%97%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.</span> <span class="toc-text">二、Pandas 清洗数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A3%80%E6%B5%8B%E4%B8%8E%E5%A4%84%E7%90%86%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="toc-number">1.2.1.</span> <span class="toc-text">1、检测与处理重复值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%A3%80%E6%B5%8B%E4%B8%8E%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">1.2.2.</span> <span class="toc-text">2、检测与处理缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%A3%80%E6%B5%8B%E4%B8%8E%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%80%BC"><span class="toc-number">1.2.3.</span> <span class="toc-text">3、检测与处理异常值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-pandas%E9%87%8F%E7%BA%B2%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.</span> <span class="toc-text">三、Pandas 量纲化数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BD%92%E4%B8%80%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、 归一化数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%A0%87%E5%87%86%E5%B7%AE%E6%A0%87%E5%87%86%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、 标准差标准化数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-pandas%E5%8F%98%E6%8D%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.</span> <span class="toc-text">四、Pandas 变换数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%93%91%E5%8F%98%E9%87%8F%E5%A4%84%E7%90%86%E7%B1%BB%E5%88%AB%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、哑变量处理类别型数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%A6%BB%E6%95%A3%E5%8C%96%E8%BF%9E%E7%BB%AD%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、离散化连续型数据</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2024/06/17/Educational/python/Data-analysis/Data_analysis_review1/" rel="bookmark" title="数据分析复习（第一章）">数据分析复习（第一章）</a></li><li><a href="/2024/06/18/Educational/python/Data-analysis/Data_analysis_review2/" rel="bookmark" title="数据分析复习（第二章）">数据分析复习（第二章）</a></li><li><a href="/2024/06/18/Educational/python/Data-analysis/Data_analysis_review3/" rel="bookmark" title="数据分析复习（第三章）">数据分析复习（第三章）</a></li><li class="active"><a href="/2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/" rel="bookmark" title="数据分析复习（第四章）">数据分析复习（第四章）</a></li><li><a href="/2024/06/22/Educational/python/Data-analysis/Data_analysis_review/" rel="bookmark" title="数据分析试题复习">数据分析试题复习</a></li><li><a href="/2024/06/23/Educational/python/Data-analysis/Data-Questions1/" rel="bookmark" title="数据分析模拟卷1">数据分析模拟卷1</a></li><li><a href="/2024/06/23/Educational/python/Data-analysis/Data-Questions2/" rel="bookmark" title="数据分析模拟卷2">数据分析模拟卷2</a></li><li><a href="/2024/06/24/Educational/python/Data-analysis/Data-code/" rel="bookmark" title="代码">代码</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="萝卜仔" data-src="/images/avatar.png"><p class="name" itemprop="name">萝卜仔</p><div class="description" itemprop="description">Only studying is exalted.</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">34</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">14</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhaW55Ymx1ZTEwMDE=" title="https:&#x2F;&#x2F;github.com&#x2F;rainyblue1001"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS84MC04Mi0zNC0zNg==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;80-82-34-36"><i class="ic i-zhihu"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9SYWRpc2g=" title="https:&#x2F;&#x2F;about.me&#x2F;Radish"><i class="ic i-address-card"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnJhaW55Ymx1ZV8xMDAxQGZveG1haWwuY29t" title="mailto:rainyblue_1001@foxmail.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/collection/" rel="section"><i class="ic i-heart"></i>收藏</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/06/18/Educational/python/Data-analysis/Data_analysis_review3/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/06/19/Educational/WeChat/WeChat_Program1/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/python/" title="分类于 Python语言">Python语言</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/python/Data-analysis/" title="分类于 数据分析">数据分析</a></div><span><a href="/2024/06/24/Educational/python/Data-analysis/Data-code/" title="代码">代码</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/WeChat/" title="分类于 微信小程序开发">微信小程序开发</a></div><span><a href="/2024/06/23/Educational/WeChat/WX-Questions3/" title="微信小程序模拟题3">微信小程序模拟题3</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Healthy-Living/" title="分类于 健康生活">健康生活</a></div><span><a href="/2024/05/25/Healthy-Living/%E5%81%A5%E5%BA%B7%E7%94%9F%E6%B4%BB/" title="健康生活">健康生活</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/WeChat/" title="分类于 微信小程序开发">微信小程序开发</a></div><span><a href="/2024/06/23/Educational/WeChat/WX-Questions1/" title="微信小程序模拟题1">微信小程序模拟题1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/Software/" title="分类于 软件项目管理">软件项目管理</a></div><span><a href="/2024/06/21/Educational/Software/software-project-review/" title="软件项目管理复习大纲">软件项目管理复习大纲</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/python/" title="分类于 Python语言">Python语言</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/python/Data-analysis/" title="分类于 数据分析">数据分析</a></div><span><a href="/2024/06/23/Educational/python/Data-analysis/Data-Questions2/" title="数据分析模拟卷2">数据分析模拟卷2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Interests/" title="分类于 兴趣类">兴趣类</a></div><span><a href="/2024/05/25/Interests/%E5%85%B4%E8%B6%A3%E7%88%B1%E5%A5%BD/" title="兴趣爱好">兴趣爱好</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/python/" title="分类于 Python语言">Python语言</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/python/Data-analysis/" title="分类于 数据分析">数据分析</a></div><span><a href="/2024/06/18/Educational/python/Data-analysis/Data_analysis_review3/" title="数据分析复习（第三章）">数据分析复习（第三章）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/WeChat/" title="分类于 微信小程序开发">微信小程序开发</a></div><span><a href="/2024/06/20/Educational/WeChat/WX_Exercises/" title="微信小程序试题复习">微信小程序试题复习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Educational/" title="分类于 学习类">学习类</a> <i class="ic i-angle-right"></i> <a href="/categories/Educational/WeChat/" title="分类于 微信小程序开发">微信小程序开发</a></div><span><a href="/2024/06/19/Educational/WeChat/WeChat_Program4/" title="第四章：微信小程序常用API（上）">第四章：微信小程序常用API（上）</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">萝卜仔 @ ShokaBlog</span></div><div class="timing"><span id="RunTime"></span><script>var BootDate = new Date("2021/10/24 23:00:00"); &#123;# 站点起始时间 #&#125;
    function ShowRunTime(id) {
      var NowDate = new Date();
      var RunDateM = parseInt(NowDate - BootDate);
      var RunDays = Math.floor(RunDateM/(24*3600*1000));
      var RunHours = Math.floor(RunDateM%(24*3600*1000)/(3600*1000));
      var RunMinutes = Math.floor(RunDateM%(24*3600*1000)%(3600*1000)/(60*1000));
      var RunSeconds = Math.round(RunDateM%(24*3600*1000)%(3600*1000)%(60*1000)/1000);
      var RunTime = RunDays + " &#123;&#123; __('footer.days') &#125;&#125; " + RunHours + " &#123;&#123; __('footer.hours') &#125;&#125; " + RunMinutes + " &#123;&#123; __('footer.minutes') &#125;&#125; " + RunSeconds + " &#123;&#123; __('footer.seconds') &#125;&#125;";
      document.getElementById(id).innerHTML = "&#123;&#123; __('footer.timing') &#125;&#125; " + RunTime;
    }
    setInterval("ShowRunTime('RunTime')", 1000);</script></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">309k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">12:53</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/06/18/Educational/python/Data-analysis/Data_analysis_review4/",favicon:{show:"恭喜！发现宝藏啦",hide:"哎呀！离开页面了"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(a){return a.includes("#")},function(a){return new RegExp(LOCAL.path+"$").test(a)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>